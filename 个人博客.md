@[TOC]

# Hexo

``` 
https://nodejs.org/download/release/v10.15.3/ 安装node
npm install -g cnpm --registry=https://registry.npm.taobao.org	安装cnpm
npm config set registry https://registry.npm.taobao.org	使用npm淘宝源
npm install -g hexo-cli
hexo init blog
cd blog
npm install
```

# Nexmoe

``` 
cd themes
git clone https://github.com/nexmoe/hexo-theme-nexmoe.git nexmoe
cd nexmoe
git checkout master
npm i --save hexo-wordcount
npm i hexo-deployer-git --save 
npm i -g gulp --save
cp -i _config.example.yml _config.yml
```
vim package.json

``` 
"scripts": {
    "build": "hexo clean && hexo g && gulp && hexo d & git add * & git commit -m '加油' & git push origin master",
    "test": "hexo clean && hexo g && gulp && hexo s",
    "dev": "hexo clean && hexo g && hexo s"
  },
``` 
默认自动开启github pages
![enter description here](https://www.github.com/OneJane/blog/raw/master/小书匠/1566209438050.png)
# 使用

``` 
npm install gulp
npm install --save-dev gulp
npm install gulp-htmlclean gulp-htmlmin gulp-minify-css gulp-uglify gulp-imagemin --save
```
gulpfile.js

``` 
var gulp = require('gulp');
var minifycss = require('gulp-minify-css');
var uglify = require('gulp-uglify');
var htmlmin = require('gulp-htmlmin');
var htmlclean = require('gulp-htmlclean');
var imagemin = require('gulp-imagemin');
 
// 压缩html
gulp.task('minify-html', function() {
    return gulp.src('./public/**/*.html')
        .pipe(htmlclean())
        .pipe(htmlmin({
            removeComments: true,
            minifyJS: true,
            minifyCSS: true,
            minifyURLs: true,
        }))
        .pipe(gulp.dest('./public'))
});
// 压缩css
gulp.task('minify-css', function() {
    return gulp.src('./public/**/*.css')
        .pipe(minifycss({
            compatibility: 'ie8'
        }))
        .pipe(gulp.dest('./public'));
});
// 压缩js
gulp.task('minify-js', function() {
    return gulp.src('./public/js/**/*.js')
        .pipe(uglify())
        .pipe(gulp.dest('./public'));
});
// 压缩图片
gulp.task('minify-images', function() {
    return gulp.src('./public/images/**/*.*')
        .pipe(imagemin(
        [imagemin.gifsicle({'optimizationLevel': 3}), 
        imagemin.jpegtran({'progressive': true}), 
        imagemin.optipng({'optimizationLevel': 7}), 
        imagemin.svgo()],
        {'verbose': true}))
        .pipe(gulp.dest('./public/images'))
});
// 默认任务
gulp.task('default', [
    'minify-html','minify-css','minify-js','minify-images'
]);
```
hexo g && gulp
## _config.yml

``` avrasm
title: OneJane
subtitle: 码农养成记
description: 
keywords: Spring Cloud,Docker,Dubbo
author: OneJane
language: zh-CN
timezone: Hongkong

url: https://onejane.github.io/
theme: nexmoe
deploy:
  type: git
  repo:
    github: git@github.com:OneJane/OneJane.github.io.git
  branch: master
  message: github
```
## themes/nexmoe/_config.yml

``` awk
avatar: https://i.loli.net/2019/08/20/UIhTqdQiPasxLtr.jpg # 网站 Logo
background: https://i.loli.net/2019/01/13/5c3aec85a4343.jpg # 既是博客的背景，又是文章默认头图
favicon:
  href: /img/a.ico # 网站图标
  type: image/png # 图标类型，可能的值有(image/png, image/vnd.microsoft.icon, image/x-icon, image/gif)
social:
  GitHub:
    - https://github.com/OneJane
    - icon-github
    - rgb(25, 23, 23)
    - rgba(25, 23, 23, .15)  
analytics:
  la_site_id: 20279757
comment: gitment
gitment:
  owner: onejane # 持有该 repo 的 GitHub username
  repo: onejane.github.io # 存放评论的 issue 所在的 repo
  clientID: e677e59382e1c7a468fd # GitHub Client ID
  clientSecret: 717d041bc4ab749f069314862232cfb6ec8adc15 # GitHub Client Secret
```
# Question
## AssertionError [ERR_ASSERTION]: Task function must be specified?

``` xquery
"devDependencies": {
    "gulp": "^3.9.1"
  }
```
npm install
## GulpUglifyError:unable to minify JavaScript
npm install gulp-util --save-dev

``` javascript
var gutil = require('gulp-util');

// 压缩public目录下的所有js
gulp.task('minify-js', function() {
    return gulp.src('./public/**/*.js')
      .pipe(uglify())
	  .on('error', function (err) { gutil.log(gutil.colors.red('[Error]'), err.toString()); }) //增加这一行
      .pipe(gulp.dest('./public'));
		
});
```

## gittalk Error：validation failed
gitalk.ejs  id: window.location.pathname改为id: decodeURI(window.location.pathname)
详情见：
https://github.com/OneJane/blog